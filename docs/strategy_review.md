# 高频交易策略评审方案 - 纯盈利导向

> **核心理念**：从"纯盈利"（非做市/不以供流动性为目的）角度重构执行逻辑，实现可量化的盈利门槛与最小可行落地

---

## 结论（TL;DR）

* 方案的工程与风控框架是对的，但若目标是**赚钱而非赚回扣**，应把默认执行从"被动挂单（maker）"切换为"**确定性成交（IOC/贴盘口限价）**"，将 **rebate 视为锦上添花**而非核心来源。
* 盈利关键在于：**信号的前瞻性强度 × 成交确定性 × 单笔期望值（扣除 taker 费/冲击/滑点）**。
* 强烈建议先做"**IOC-only 压力测试**"：如果去掉全部 maker 仍能盈利，策略就是真正的 **alpha 策略**；否则是在用执行技巧掩盖信号不足。

---

## 一、盈利模型与门槛（把钱算清楚）

以永续合约常见费率做一个通用盈亏模型：

```
E[trade] = p·g - (1-p)·l - fee - slip - impact
```

**参数说明**：
* `p`：胜率（Win Rate）
* `g, l`：盈利/亏损的**无摩擦**平均幅度（bps）
* `fee`：taker 费（如 5 bps）
* `slip + impact`：成交滑点与冲击（2–10 bps，视品种与时段）

### IOC-only 盈亏平衡

对称止盈止损（`g = l`）情况下：

```
p* ≈ 1/2 + (fee + slip + impact) / (2g)
```

**实例计算**：
* 若 `g = 20 bps`、费用+滑点合计 `8 bps`
* 则 `p* ≈ 0.5 + 8/40 = 0.70`
* **结论**：需要 70% 胜率才能盈亏平衡

### 盈利三要素

要提高期望收益，必须：
1. **提高单笔边际（g）**：更大的盈利空间
2. **降低成交成本**：优化 fee/滑点/冲击
3. **提高胜率（p）**：更准确的信号

### 落地建议

在回测与实盘归因中，**单独统计**：
* **方向性收益（Alpha）**：纯信号带来的盈利
* **手续费（Fee）**：交易成本
* **滑点（Slippage）**：执行偏差
* **回扣（Rebate）**：maker 奖励
* **冲击（Impact）**：市场冲击成本

**健康标准**：
* 若"回扣 + Carry" > "方向性收益"的 30%，说明策略更接近做市而非盈利策略
* **需减少 maker 依赖**，回归信号驱动

---

## 二、执行逻辑重构：从"被动优先"到"确定性优先"

### 原方案的偏差

* EV 比较器把 **passive（被动挂单）** 设为常态，这是做市心智
* 盈利策略应优先**成交确定性**，而非手续费优化

### 修正准则：强信号就打、弱信号才蹭

#### 1. 高置信度（|Score| > θ₁）
* **默认执行**：**IOC / 贴盘口限价**
* **目标**：立刻抓住价格漂移，确保成交
* **理由**：信号强时，Alpha 远大于手续费差异

#### 2. 中置信度（θ₂ < |Score| ≤ θ₁，低波动/低空洞）
* **可用策略**：**浅被动**（距离 mid ≤ 1–2 tick）
* **超时机制**：设置超时或 mid 偏移阈值 → 自动切 IOC
* **理由**：在流动性好时，浅被动可降低成本且不影响成交

#### 3. 低置信度（|Score| ≤ θ₂）
* **策略**：**不交易**
* **禁止**：杜绝"靠回扣赌成交"的投机行为

### 实操提示

* **贴盘口限价（Aggressive Limit）** 优先级常足以立刻成交
* 比市价单更可控，可轻度熨平滑点
* 比被动挂单更确定，避免排队风险

---

## 三、简化执行：从队列精算到市场可交易性

### 放弃重度队列建模

* **不要**做重度排队建模（那是做市商的"成本最优化"问题）
* 高频盈利策略的核心是**信号强度**，不是排队优化

### 使用盘口可交易性（Tradeability）

**定义**：
```
Tradeability = BestDepth / EatRate_{100ms}
```

**含义**：
* `BestDepth`：最优价位的挂单深度
* `EatRate_{100ms}`：过去 100ms 的吃单速率
* 低于某阈值（如 < 200ms）→ **放弃挂被动，直接 IOC**

### 简化撤单逻辑

只需两条规则：
1. **mid 偏离 > X bps**：市场价格大幅变动 → 撤单并切 IOC
2. **盘口结构变更**：best depth 大幅减少/价阶跳变 → 撤单并切 IOC

**优势**：
* 避开"虚假流动性"
* 把研发精力集中到"信号与成交确定性"

---

## 四、信号优先：先证伪，再优化执行

### 信号前瞻性检验

对每个信号做 **t → t+Δ 的 mid 变动回归/分层 IC**：

**目标指标**：
* **IC（Spearman）≥ 0.03**：信号与未来收益相关性
* **分层收益（Top vs Bottom）> 成交成本**：信号分层能力

**稳健性要求**：
* **跨波动**：高波动/低波动都稳定
* **跨时段**：不同交易时段都有效

### 盘口信号的状态过滤

对易失效的盘口信号（OBI、microprice），加入**状态过滤**：

* **低延迟—高相关**：投入更高权重
* **高延迟—低相关**：仅做风控约束，不作为入场主因

### 核心原则

> **没有 alpha 的执行优化，只是在精致地赔钱**

---

## 五、风控：从"停机"到"动态降频/换模式"

### 硬熔断（停机）仅保留

* **单笔亏损 > 0.8% 净值**
* **日回撤 > 5%**
* **API 异常/预言机异常**

### 其余改为模式切换

#### 1. 高波动环境
* **调整**：放大止损/止盈、缩短持有时长
* **理由**：避免被噪声止损

#### 2. 低流动性环境
* **调整**：只用 IOC、减小下单尺寸
* **理由**：避免冲击成本过高

#### 3. Funding 极端
* **调整**：禁逆势 carry，但允许顺势跟随
* **理由**：避免被资金费率侵蚀

---

## 六、验证路径（从"能赚"出发）

### A/B 实验设计

#### 实验 1：IOC-only 基线
* **设置**：全品种只用 IOC/贴盘口限价执行
* **目标**：拿到 **真实 Alpha 基线**
* **验证**：去除 maker 后是否仍能盈利

#### 实验 2：+浅被动增强
* **设置**：在基线之上，仅当 Tradeability 良好且 |Score| 中等时，叠加浅被动
* **目标**：比较 **净收益/成本下降**是否显著
* **验证**：浅被动是否真正降低成本而不影响成交

#### 实验 3：去平台/去时段稳健性
* **设置**：BTC/ETH vs 小币；高波动日 vs 平静日
* **目标**：验证策略的泛化能力
* **验证**：不同市场环境下是否稳定盈利

### 必看曲线与表

1. **Alpha vs 成交成本**的"刀叉图"（per regime）
2. **信号强度分桶**的胜率/期望值
3. **延迟 → Alpha 衰减**曲线（发现最佳 Δt 窗口）
4. **PnL 归因**：
   * Alpha ≥ 70%
   * Fee + Slip ≤ 25%
   * Rebate ≤ 10%（盈利导向的健康结构）

---

## 七、资金管理与规模化

### 头寸公式

```
Size = min(α · Score · (c/σ), MaxPos)
```

**参数说明**：
* `α`：资金利用系数
* `Score`：信号强度
* `c`：资金总量
* `σ`：波动率
* `MaxPos`：最大持仓限制

### 增加库存偏置（Inventory Bias）

* 抑制单边暴露，避免方向性风险累积

### 成交成本弹性

随着下单尺寸增长：
* **冲击/滑点非线性上升**
* 以"**边际 E[trade] 归零**"作为增量上限
* 防止规模化把 alpha 挤没

---

## 八、两周落地计划（只做盈利必需件）

### Week 1：拿到 IOC-only 基线

#### 1. 数据与回放
* **任务**：L2 + trades 录制/回放
* **输出**：含 taker 费、滑点估计的数据集

#### 2. 信号检验
* **任务**：OBI/microprice/冲击信号前瞻性 IC 与分层收益
* **验证**：跨时段/品种稳健性

#### 3. IOC 执行器
* **任务**：WebSocket 直连 + 贴盘口限价
* **统计**：真实滑点/冲击分布

#### 4. 硬熔断
* **任务**：单笔、日回撤、API 异常检测与停机

### Week 2：加浅被动与模式切换

#### 5. Tradeability 因子
* **任务**：以 100–200ms 窗口评估档位稳定性
* **应用**：加入执行决策

#### 6. 浅被动增强
* **任务**：仅中置信度、良好 Tradeability 时启用
* **机制**：带超时/偏离自动切 IOC

#### 7. PnL 归因与规模化测试
* **任务**：Alpha/Cost/回扣分解
* **实验**：尺寸从 1× → 2× → 3× 梯度实验，画"边际期望值"曲线

---

## 九、关键验证问题（团队自检清单）

### 1. Alpha 真实性
**问**：去掉全部 maker，只用 IOC，是否仍能盈利？
* **Yes** → 真正的 alpha 策略
* **No** → 在用执行技巧掩盖信号不足

### 2. 信号质量
**问**：IC > 0.03 的信号有几个？跨时段/品种还能站得住吗？
* 至少需要 **1–2 个稳定信号**

### 3. PnL 结构健康度
**问**：Alpha 占 PnL 比例 ≥ 70% 吗？
* **Yes** → 盈利策略
* **No** → 做市策略（不符合目标）

### 4. 延迟敏感性
**问**：延迟每增加 50ms，单笔期望值下降多少？
* 决定是否值得继续压榨工程延迟

### 5. 规模上限
**问**：放大下单尺寸后，边际 E[trade] 何时归零？
* 决定策略的资金容量

---

## 十、一句话总结

> **把默认执行改成"信号强时立刻成交、信号弱时不勉强"；让 maker 只在中性/低波动当作成本优化选项。先跑出 IOC-only 的真 Alpha，再谈任何挂单与排队的花活。**

---

## 附录：术语表

| 术语 | 解释 |
|------|------|
| **IOC** | Immediate-Or-Cancel，立即成交或取消 |
| **Maker** | 被动挂单方，提供流动性，享受 rebate |
| **Taker** | 主动吃单方，消耗流动性，支付 fee |
| **Alpha** | 信号带来的超额收益（扣除市场基准） |
| **IC** | Information Coefficient，信号与收益的相关性 |
| **Slippage** | 滑点，预期价格与成交价格的差异 |
| **Impact** | 冲击，大单对市场价格的影响 |
| **Tradeability** | 可交易性，盘口深度与吃单速率的比值 |
| **OBI** | Order Book Imbalance，订单簿不平衡度 |
| **Microprice** | 微观价格，基于订单簿加权的理论价格 |

---

**文档版本**：v1.0
**最后更新**：2025-10-25
**适用项目**：Hyperliquid 高频交易系统
